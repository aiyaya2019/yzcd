<include file='common/meta' />

<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-form" lay-filter="layuiadmin-form-admin" style="padding: 20px 30px 1px 0;">
            <form action="" class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">门店名称</label>
                    <div class="layui-input-block">
                        <input type="text" name="title" value="{$config.title}" autocomplete="off" placeholder="请输入门店名称" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">LOGO</label>
                    <div class="layui-input-block layui-upload">
                        <button type="button" class="layui-btn layui-btn-normal file" id="test1"><i class="layui-icon"></i>上传封面</button>
                        <input class="layui-upload-file" type="file" accept="undefined" name="file" id="test1s">
                        <span class="layui-inline layui-upload-choose">支持 png、jpg、jpeg 格式文件</span>
                        <img style="width:70px" id="img" src="{$config.logo}" alt="">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">LOGO</label>
                    <div class="layui-input-block layui-upload">
                        <button type="button" class="layui-btn layui-btn-normal file" id="test2"><i class="layui-icon"></i>邀请码背景图</button>
                        <input class="layui-upload-file" type="file" accept="undefined" name="files" id="test2s">
                        <span class="layui-inline layui-upload-choose">支持 png、jpg、jpeg 格式文件</span>
                        <img style="width:70px" id="back_img" src="{$config.back_img}" alt="">
                    </div>
                </div>


                <div class="layui-form-item">
                    <label class="layui-form-label">APPID</label>
                    <div class="layui-input-block">
                        <input type="text" name="appid" value="{$config.appid}" autocomplete="off" placeholder="请输入APPID" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">AppSecret</label>
                    <div class="layui-input-block">
                        <input type="text" name="appsecret" value="{$config.appsecret}" autocomplete="off" placeholder="请输入AppSecret" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">Mch_id</label>
                    <div class="layui-input-block">
                        <input type="text" name="mchid" value="{$config.mchid}" autocomplete="off" placeholder="请输入商户号" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">KEY</label>
                    <div class="layui-input-block">
                        <input type="text" name="key" value="{$config.key}" autocomplete="off" placeholder="请输入支付KEY" class="layui-input">
                    </div>
                </div>

                <!-- <div class="layui-form-item">
                    <label class="layui-form-label">基础运费</label>
                    <div class="layui-input-block">
                        <input type="text" name="fare_money" value="{$config.fare_money}"  autocomplete="off" placeholder="请输入商品基础运费" class="layui-input">
                    </div>
                </div> -->

                <div class="layui-form-item">
                    <label class="layui-form-label">联系电话</label>
                    <div class="layui-input-block">
                        <input type="text" name="cust_tel" value="{$config.cust_tel}"  autocomplete="off" placeholder="请输入客服电话" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">邀请得积分</label>
                    <div class="layui-input-block">
                        <input type="number" name="point" value="{$config.point}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">分销得积分</label>
                    <div class="layui-input-block">
                        <input type="number" name="p_point" value="{$config.p_point}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">红包/元</label>
                    <div class="layui-input-block" style="float:left; margin-left:0;margin-right:5px;">
                        <input type="number" name="min_red" value="{$config.min_red}"  autocomplete="off" placeholder="请输入" class="layui-input" style="width:100px;">
                    </div>
                    <div class="layui-input-block" style="float:left; margin-left:0;margin-right:5px;line-height: 36px;">
                       ~
                    </div>
                    <div class="layui-input-block" style="float:left; margin-left:0;margin-right:5px;">
                        <input type="number" name="max_red" value="{$config.max_red}"  autocomplete="off" placeholder="请输入" class="layui-input" style="width:100px;">
                    </div>
                </div>


                <div class="layui-form-item ">
                    <label class="layui-form-label">红包发放时间</label>
                    <div class="layui-input-inline">
                        <input type="text" name="red_start_time" value="{$config.red_start_time}" id="start" autocomplete="off" placeholder="红包发放开始时间" class="layui-input">
                    </div>
                    <div class="layui-form-mid" style="margin-left:10px">至</div>
                    <div class="layui-input-inline">
                        <input type="text" name="red_end_time" value="{$config.red_end_time}" id="end" autocomplete="off" placeholder="红包发放结束时间" class="layui-input">
                    </div>
                </div>


                <div class="layui-form-item">
                    <label class="layui-form-label">门店合伙人费用</label>
                    <div class="layui-input-block">
                        <input type="number" name="shop_money" value="{$config.shop_money}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">城市合伙人费用</label>
                    <div class="layui-input-block">
                        <input type="number" name="city_money" value="{$config.city_money}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">门店合伙人分红期限</label>
                    <div class="layui-input-block">
                        <input type="number" name="shop_time" value="{$config.shop_time}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">城市合伙人分红期限</label>
                    <div class="layui-input-block">
                        <input type="number" name="city_time" value="{$config.city_time}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">分红到账期限/天</label>
                    <div class="layui-input-block">
                        <input type="number" name="bonus_time" value="{$config.bonus_time}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <!-- <div class="layui-form-item">
                    <label class="layui-form-label">门店分红续期费用</label>
                    <div class="layui-input-block">
                        <input type="number" name="shop_bonus_money" value="{$config.shop_bonus_money}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">城市分红续期费用</label>
                    <div class="layui-input-block">
                        <input type="number" name="city_bonus_money" value="{$config.city_bonus_money}"  autocomplete="off" placeholder="请输入" class="layui-input">
                    </div>
                </div> -->



                <div class="layui-form-item">
                    <label class="layui-form-label">优惠券规则</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入优惠券规则" lay-verify="required" name="rule" class="layui-textarea edit">{$config.rule}</textarea>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">提现说明</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入提现说明" lay-verify="required" name="cash_explain" class="layui-textarea edit">{$config.cash_explain}</textarea>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">预约须知</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入预约须知" lay-verify="required" name="reserve_notice" class="layui-textarea edit">{$config.reserve_notice}</textarea>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">门店合伙人合同</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入门店合伙人合同" lay-verify="required" name="shop_contract" class="layui-textarea edit">{$config.shop_contract}</textarea>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">城市合伙人合同</label>
                    <div class="layui-input-block">
                        <textarea placeholder="请输入城市合伙人合同" lay-verify="required" name="city_contract" class="layui-textarea edit">{$config.city_contract}</textarea>
                    </div>
                </div>


                <!-- <div class="layui-form-item">
                    <label class="layui-form-label">门店地址</label>
                    <div class="layui-input-block">
                        <input type="text" name="work_time" value="{$config.work_time}" autocomplete="off" placeholder="请输入客服工作时间" class="layui-input">
                    </div>
                </div> -->

               <!--  <div class="layui-form-item">
                    <label class="layui-form-label">门店经度</label>
                    <div class="layui-input-block">
                        <input type="text" name="long" value="{$config.long}" autocomplete="off" placeholder="请输入客服工作时间" class="layui-input">
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">门店纬度</label>
                    <div class="layui-input-block">
                        <input type="text" name="lat" value="{$config.lat}" autocomplete="off" placeholder="请输入客服工作时间" class="layui-input">
                    </div>
                </div> -->

                <!-- <div class="layui-form-item">
                    <label class="layui-form-label">门店介绍</label>
                    <div class="layui-input-block">
                        <textarea name="desc" placeholder="请输入内容" class="layui-textarea">{$config.desc}</textarea>
                    </div>
                </div> -->

                <div class="layui-form-item">
                    <label class="layui-form-label"></label>
                    <div class="layui-input-inline">
                        <input type="button" lay-submit id="transmit" lay-filter="LAY-user-back-submit" value="确认" class="layui-btn">
                        <!-- <button type="reset" class="layui-btn layui-btn-primary" onclick="javascript:history.go(-1)">返回</button> -->
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<include file='common/edit' />
<script>

    layui.use(['form','laydate'],function(){
        var form = layui.form;
        var laydate = layui.laydate;

        //开始时间
        laydate.render({
            elem: '#start', //指定元素
            type:'datetime',
            done:function(value,date){
                end.config.min = {
                    year:date.year,
                    month:date.month-1, 
                    date: date.date,
                };
                if(value > $('#end').val()){
                    $('#end').val('');
                }
            }
        });

        var end = laydate.render({
            elem: '#end', //指定元素
            type:'datetime',
        });
        
    })



    //表单上传
    fromUpload('form',"{:url('Config/index')}",function(data){
        if(data.code == 200){
            layer.msg(data.msg,{time:1500});
        } else {
            layer.msg(data.msg,{time:3000});
        }
    });

    //图片阅览
    $('#test1').click(function(){
        $('#test1s').click();
    })
    $('#test1s').change(function(e){
        var imgBox = e.target;
        var img = getObjectURL(imgBox.files[0]);
        $('#img').attr('src',img);
    });


    //图片阅览
    $('#test2').click(function(){
        $('#test2s').click();
    })
    $('#test2s').change(function(e){
        var imgBox = e.target;
        var img = getObjectURL(imgBox.files[0]);
        $('#back_img').attr('src',img);
    });

    //建立一個可存取到該file的url
    function getObjectURL(file) {
        var url = null;
        if (window.createObjectURL != undefined) { // basic
            url = window.createObjectURL(file);
        } else if (window.URL != undefined) { // mozilla(firefox)
            url = window.URL.createObjectURL(file);
        } else if (window.webkitURL != undefined) { // webkit or chrome
            url = window.webkitURL.createObjectURL(file);
        }
        return url;
    }


    $('.edit').editable({
        inlineMode: false, 
        alwaysBlank: true,
        language: "zh_cn",
        imageUploadURL:"{:url('common/fileUpload')}"
    }) 
</script>